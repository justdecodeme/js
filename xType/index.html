<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Typing App</title>
    <style media="screen">
      #typingArea {
        font-size: 70px;
      }
      .active { background: lightblue; }
      .success { color: #d5d5d5; }
      .error { background: orange; }
    </style>
  </head>
  <body>
    <button id="toggleTypingBtn">Start Typing</button>
    <!-- container for letters -->
    <div id="typingArea"></div> <!-- {1} -->

    <script type="text/javascript">
      // string to be typed
      let str = 'js is.';
      // convert string to array
      let strArr = str.split('');
      let strHTML = '';
      let count = 0;
      let isTypingEnabled = false;
      let typingArea = document.querySelector('#typingArea');
      let toggleTypingBtn = document.querySelector('#toggleTypingBtn');

      // convert string array to html
      strArr.forEach(letter => {
        strHTML += `<span class="letter">${letter}</span>`
      })
      // put generated html into its container {1}
      typingArea.innerHTML = strHTML;

      // select all letters
      let letters = document.querySelectorAll('#typingArea span');
      // select last letter
      let last = document.querySelectorAll('#typingArea span')[str.length-1];
      // add active class to firt letter
      letters[0].classList.add('active');


      var checkTyping = function(e) {
        // select active letter
        let active = document.querySelector('#typingArea span.active');
        // run only if typing is enabled
        if(isTypingEnabled) {
          // check if we reached last letter or not
          if(count < str.length-1) {
            count++;
            // add active class to next element
            active.nextSibling.classList.add('active');
            // if active letter is equal to typed letter
            if(active.innerHTML == e.key) {
                active.classList.add('success');
                active.classList.remove('active');
                // if active letter is not equal to typed letter
            } else if(active.innerHTML != e.key) {
                active.classList.add('error');
                active.classList.remove('active');
            }
            // if we reached last letter
          } else {
            active.classList.remove('active');
            if(active.innerHTML == e.key) {
                active.classList.add('success');
            } else if(active.innerHTML != e.key) {
                active.classList.add('error');
            }
            setTimeout(function(){ alert("DONE!"); })
            document.removeEventListener('keyup', checkTyping, false);
          }
        }
      }
      var toggleTyping = function(e) {
        // if typing is not enabled
        if(!isTypingEnabled && e.detail == 1) { // e.detail == 1 (don't run on spacebar click)
          isTypingEnabled = !isTypingEnabled;
          toggleTypingBtn.innerHTML = 'Stop Typing';
          document.addEventListener('keyup', checkTyping, false);
        } else if(e.detail == 1) {
          isTypingEnabled = !isTypingEnabled;
          toggleTypingBtn.innerHTML = 'Start Typing';
          document.removeEventListener('keyup', checkTyping, false);
        }
      }

      toggleTypingBtn.addEventListener('click', toggleTyping, false);
    </script>
  </body>
</html>
